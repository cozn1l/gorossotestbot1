# Gorosso Telegram Shop — Полный пакет

Это готовый проект Telegram-бота-магазина для бренда **Gorosso**. 
В проекте: бот с каталогом, корзиной, оплатой через RunPay (Telegram Checkout), автогенерацией номера заказа и PDF-накладной, админ-панелью и статистикой.

---
## Содержимое архива
- `bot.py` — основной код бота.
- `requirements.txt` — зависимости Python.
- `.env.example` — пример конфигурации (переименуй в `.env` и заполни).
- `static/gorosso_logo.png` — логотип (используется в накладной).
- `static/gorosso_invoice_template.pdf` — опциональный шаблон (есть).
- `orders/` — папка для сохранения PDF-накладных.
- `gorosso.db` — sqlite БД (создаётся при первом запуске).

---
## Быстрый старт (шаг за шагом, без знаний)

1. Установи Python 3.10+.
   - Ubuntu: `sudo apt update && sudo apt install python3 python3-venv python3-pip -y`
   - Windows: скачай с https://python.org и установи.

2. Скопируй проект на свой компьютер/сервер. Предположим папка `/home/you/gorosso_bot`.

3. Перейди в папку и создай виртуальное окружение:
```
cd gorosso_bot_project_new
python3 -m venv venv
source venv/bin/activate   # на Windows: venv\Scripts\activate
pip install -r requirements.txt
```

4. Переименуй `.env.example` в `.env` и открой в текстовом редакторе. Впиши:
```
BOT_TOKEN=тут_твой_токен_бота
PROVIDER_TOKEN=тут_твой_runpay_provider_token
ADMIN_IDS=твой_telegram_user_id_или_несколько_через_запятую
CURRENCY=MDL
```

Как получить BOT_TOKEN и PROVIDER_TOKEN:
- BOT_TOKEN: в Telegram открой @BotFather -> /newbot -> следуй инструкциям -> получишь токен.
- RunPay (PROVIDER_TOKEN): регистрируйся на RunPay, запрашивай интеграционный `provider token`. В BotFather -> Payments -> Connect Provider -> вставь token (RunPay).

5. Запусти бота:
```
python bot.py
```

Если бот запустился — в терминале увидишь логи. Проверь в Telegram: /start у бота.

---
## Что умеет бот (для сотрудников)
### Админские команды (только для ADMIN_IDS)
- `/admin` — откроет меню.
- `/addcategory <Название>` — добавить категорию.
- `/addproduct` — пошаговое добавление товара: название → категория → цена → описание → размеры → цвета → остаток → фото.
- `/listproducts` — показать все товары (ID, цена, остаток).
- `/editproduct <product_id>` — изменить поля товара (пошагово).
- `/deleteproduct <product_id>` — удалить товар.
- `/orders` — список заказов (id, номер заказа, сумма, статус).
- `/setstatus <order_id> <status>` — поменять статус (processed, shipped, cancelled ...).
- `/cancelorder <order_id>` — отменить заказ и вернуть остаток на склад (фактический возврат денег делается в RunPay вручную).
- `/stats` — общая статистика продаж.

### Команды для клиентов / интерфейс
- `/start` — главнoе меню.
- Кнопка `Каталог` — выбор категории и просмотр товаров.
- В карточке товара — `Добавить в корзину` → выбор размера/цвета → добавить.
- `Корзина` — посмотреть корзину, оплатить всё, очистить.
- `Мои заказы` — история заказов и статусы.

---
## Как генерируется накладная (что происходит при оплате)
1. Клиент оплатил через Telegram Checkout (RunPay).
2. Бот получает подтверждение оплаты (Successful Payment).
3. Бот формирует уникальный номер заказа `GRS-YYYYMMDD-XXXX` и сохраняет данные в БД.
4. Бот генерирует PDF-накладную (в `orders/` ) с логотипом и списком товаров и отправляет её клиенту в чат.
5. Админ получает уведомление о новом заказе.

---
## Запуск в продакшн (коротко)
Для стабильной работы используйте VPS и systemd сервис. Я могу подготовить systemd unit и инструкцию по настройке webhook, nginx и SSL — скажи, если нужно.

---
## Важные замечания и безопасность
- НЕ публикуй `.env` с токенами. Храни их в секрете.
- Возвраты через RunPay делаются в их панели или API.
- Регулярно делай бэкап `gorosso.db` и папки `orders/`.

---
Если хочешь, я могу:
- подготовить unit-файл systemd и инструкцию для Ubuntu,
- подключить автоматические рефанды через RunPay API (если ты дашь API-ключи),
- стилизовать PDF-накладную (добавить адрес/контакты/логотип по центру).